<html>
	<head>
		<title>TASK1</title>
		<script type= "text/javascript">
			var countInput = 0;
			var SUM_OPERATION = "sum";
			var MAX_OPERATION = "max";
			var MIN_OPERATION = "min";
			var AVG_OPERATION = "avg";
			var RESULT_BEGIN_SUM = "sum(";
			var RESULT_BEGIN_MAX = "max(";
			var RESULT_BEGIN_MIN = "min(";
			var RESULT_BEGIN_AVG = "avg(";
			var ARRAY_OF_OPERATION = {};
			ARRAY_OF_OPERATION[SUM_OPERATION] = sum;
			ARRAY_OF_OPERATION[MAX_OPERATION] = max;
			ARRAY_OF_OPERATION[MIN_OPERATION] = min;
			ARRAY_OF_OPERATION[AVG_OPERATION] = avg;

			var RESULT_END = ")=";

			var DELIMITER = ", ";

			var ERROR_MESSAGE = "Your value is bad -__-";

			var FIRST_ERROR_MESSAGE_ID = "firstErrorMessage";
			
			var SECOND_ERROR_MESSAGE_ID = "secondErrorMessage";

			var COUNT_INPUT = "countInput";

			var FORM1_ID = "form1";

			var EMPTY = "";

			var PARAGRAPH_TAG = 'p';

			var MIN_COUNT_INPUT = 2;

			var MAX_COUNT_INPUT = 10;

			var RESULT_INPUT = "resultInput";

			var INPUT_ID = "inputâ„–";
			var INPUT_TAG = "input";
			
			var ZERO = 0;

			var FORM2_ID = "form2";

			var BREAK_TAG = 'br';

			var ATTRIBUTE_TEXT = "text";

			function check() {
				var go = true;
				countInput = document.forms[FORM1_ID].elements[COUNT_INPUT].value;
				if(!isInt(countInput) || countInput>MAX_COUNT_INPUT || countInput<MIN_COUNT_INPUT) {
					go = false;
					countInput  = 0;
					setMessageError(form1, FIRST_ERROR_MESSAGE_ID);
				}
				else {
					removeMessageError(FIRST_ERROR_MESSAGE_ID);
					printInputs(countInput);
				}
				return go;
			}

			function printInputs(countInput) {
				var form2 = document.getElementById(FORM2_ID);
				var attributeId = INPUT_ID;
				var attributeText = ATTRIBUTE_TEXT;
				document.getElementById(FORM2_ID).innerHTML = EMPTY;
				for(var i = 0; i<countInput; i++) {
					var input = document.createElement(INPUT_TAG);
					input.type = attributeText;
					input.id = attributeId + i;
					form2.appendChild(input);
					var br = document.createElement(BREAK_TAG);
					form2.appendChild(br);
				}
			}


			function isInt(n){return Number(n) == n && n % 1 === 0;}

			function isFloat(n){
			return Number(n) == n && n % 1 !== 0 || Number(n) == n && n % 1 === 0;
			}
			
			function setMessageError(parentElement, errorId) {
				if(!document.getElementById(errorId)) {
						var p = document.createElement(PARAGRAPH_TAG);
						p.id = errorId;
						p.innerHTML = ERROR_MESSAGE;
						parentElement.appendChild(p);
				}
			}
			
			function removeMessageError(errorId) {
				var p = document.getElementById(errorId);
				if(p!=null) {
					var p = document.getElementById(errorId);
					p.parentNode.removeChild(p);
				}
			}

			function isNumbers(countInput) {
				var good = true;
				for(var i = 0; i<countInput; i++) {
					var input = document.getElementById(INPUT_ID + i);
					if(!isFloat(input.value) || input.value==="") {
						good = false;
						break;
					}
				}
				return good;
			}

			function calculate(id) {
				var good = isNumbers(countInput);
				if(!good) {
					setMessageError(form2, SECOND_ERROR_MESSAGE_ID);
					return false;
				}
				var value = Number(document.getElementById(INPUT_ID + ZERO).value);
				var result = ARRAY_OF_OPERATION[id](value, countInput);
				printResult(result);
				removeMessageError(SECOND_ERROR_MESSAGE_ID);
				return good;
			}

			function sum(sum) {
				var result = RESULT_BEGIN_SUM + sum;
				for(var i = 1; i<countInput; i++) {
					var input = document.getElementById(INPUT_ID + i);
					sum += Number(input.value);
					result += DELIMITER + input.value;
				}
				result += RESULT_END + sum;
				return result;
				
			}

			function max(max) {
				var result = RESULT_BEGIN_MAX + max;
				for(var i = 1; i<countInput; i++) {
					var input = document.getElementById(INPUT_ID + i);
					if(max<input.value) {
						max = Number(input.value);
					}
					result += DELIMITER + input.value;
				}
				result += RESULT_END + max;
				return result;
			}

			function min(min) {
				var result = RESULT_BEGIN_MIN + min;
				for(var i = 1; i<countInput; i++) {
					var input = document.getElementById(INPUT_ID + i);
					if(min>input.value) {
						min = Number(input.value);
					}
					result += DELIMITER + input.value;
				}
				result += RESULT_END + min;
				return result;
			}


			function avg(sum) {
				var result = RESULT_BEGIN_AVG + sum;
				for(var i = 1; i<countInput; i++) {
					var input = document.getElementById(INPUT_ID + i);
					sum += Number(input.value);
					result += DELIMITER + input.value;
				}
				result += RESULT_END + sum/countInput;
				return result;
			}


			function printResult(result) {
				var resultInput = document.getElementById(RESULT_INPUT);
				resultInput.value = result;
			}
		</script>
		<style>
			.form{
				height: 500px;
			}
		</style>
	</head>
	<body>
		<form id = "form1" class="form">
			<p>
				<label for = "countInput" >values number (from 2 to 10)</label> 
				<input type = "text" id = "countInput"/>
			</p>
			<p>
				<a id = "reference" href="#form2" onclick = "return check()">generate inputs</a>
			</p>
		</form>
		
		<div class="form">
			<form id = "form2">
				
			</form> 
			<p>
				<a id = "sum" href = "#form3" onclick = "return calculate(id)">sum</a>
			</p>
			<p>
				<a id = "max" href = "#form3" onclick = "return calculate(id)">max</a>
			</p>
			<p>
				<a id = "min" href = "#form3" onclick = "return calculate(id)">min</a>
			</p>
			<p>
				<a id = "avg" href = "#form3" onclick = "return calculate(id)">avg</a>
			</p>
		</div>

		<form id = "form3" class="form">
			<input id = "resultInput" type = "text"/>
			<p>
				<a href = "#form1">next round</a>
			</p>
		</form>
	</body>
</html>